{# templates/pwa/escape/wizard/_infos_step.html.twig #}
{# Usage: {% include 'pwa/escape/wizard/_infos_step.html.twig' with { step: 3, eg: eg, puzzle: puzzle } %} #}

<aside class="step-card">
    {% include 'pwa/escape/wizard/_mode_emploi.html.twig' with { step: step } %}

    {% set s = step|default(0) %}
    <div class="step-section">
        <h3>Ce que tu dois pr√©parer</h3>
        <ul class="checklist">
            {% if s == 1 %}
                <li>Un <strong>mot secret</strong> (4‚Äì8 lettres conseill√©es)</li>
                <li>Un <strong>message</strong> qui s‚Äôaffichera si le mot est trouv√©</li>
            {% elseif s == 2 %}
                <li>Un <strong>lieu pr√©cis</strong> (sur la carte) et un <strong>rayon</strong> (ex. 100 m)</li>
                <li>Un <strong>QR code</strong> pointant vers cette √©tape (√† imprimer)</li>
            {% elseif s == 3 %}
                <li>Une <strong>image</strong> (jpeg/png/webp) de bonne qualit√©</li>
                <li>Le <strong>nombre de cases</strong> (ex. 3√ó3)</li>
            {% elseif s == 4 %}
                <li>1‚Äì3 <strong>questions</strong> avec <strong>r√©ponses</strong> (cases √† cocher)</li>
                <li>La <strong>combinaison correcte</strong> (must / mustNot)</li>
            {% elseif s == 5 %}
                <li>Une <strong>vid√©o .mp4</strong> courte (15‚Äì60 s id√©al)</li>
                <li>Les <strong>moments</strong> o√π poser les questions (en secondes)</li>
            {% elseif s == 6 %}
                <li>Un <strong>code de d√©part</strong> (HTML simple)</li>
                <li>Les <strong>r√®gles</strong> √† v√©rifier (s√©lecteurs/texte)</li>
            {% endif %}
        </ul>
    </div>

    <div class="step-section">
        <h3>Param√®tres cl√©s</h3>
        <ul class="bullets">
            {% if s == 1 %}
                <li>Mot secret, alphabet, m√©lange, validation auto, message succ√®s.</li>
            {% elseif s == 2 %}
                <li>Latitude/longitude, rayon (m), messages OK / hors zone / HTTPS.</li>
            {% elseif s == 3 %}
                <li>Image, lignes √ó colonnes, message succ√®s.</li>
            {% elseif s == 4 %}
                <li>Questions[], options (id/label), solution: must[], mustNot[], messages OK/KO.</li>
            {% elseif s == 5 %}
                <li>Vid√©o, cues: { time, question, options[], answer, feedbackOk/Ko }, message final.</li>
            {% elseif s == 6 %}
                <li>HTML de d√©part, checks: selectorExists / textIncludes / selectorCountAtLeast, message final.</li>
            {% endif %}
        </ul>
    </div>

    <div class="step-section">
        <h3>Astuces</h3>
        <ul class="bullets">
            {% if s == 1 %}
                <li>Privil√©gie 4‚Äì6 lettres pour que ce soit fun mais pas trop dur.</li>
                <li>Le message succ√®s peut contenir un <em>indice</em> pour l‚Äô√©tape suivante.</li>
            {% elseif s == 2 %}
                <li>Teste sur <strong>HTTPS</strong> (obligatoire pour le GPS) ‚Äî localhost OK en dev.</li>
                <li>Pr√©vois un petit <em>indice de direction</em> si les joueurs sont hors zone.</li>
            {% elseif s == 3 %}
                <li>√âvite les images trop uniformes ; des zones contrast√©es aident √† jouer.</li>
                <li>3√ó3 pour enfants, 4√ó4 ou 5√ó5 pour plus de d√©fi.</li>
            {% elseif s == 4 %}
                <li>Des intitul√©s courts et clairs. 1 pi√®ge max par question üòâ</li>
                <li>Explique dans l‚Äô√©nonc√© ce que tu attends (ex. ‚ÄúCoche les vraies affirmations‚Äù).</li>
            {% elseif s == 5 %}
                <li>Pose 1 question toutes les 10‚Äì20 secondes, pas plus.</li>
                <li>La r√©ponse doit vraiment d√©pendre de la **vid√©o** (ce qu‚Äôon voit/entend).</li>
            {% elseif s == 6 %}
                <li>Donne un exemple dans le starter (ex. un &lt;h1&gt; d√©j√† pr√©sent √† compl√©ter).</li>
                <li>Commence par 1‚Äì2 checks maximum pour rester accessible.</li>
            {% endif %}
        </ul>
    </div>

    <div class="step-section subtle">
        <h3>Pi√®ges fr√©quents</h3>
        <ul class="bullets">
            {% if s == 1 %}
                <li>Mot vide ou trop long : le cadenas devient p√©nible.</li>
            {% elseif s == 2 %}
                <li>Essayer en HTTP : la g√©oloc est bloqu√©e.</li>
            {% elseif s == 3 %}
                <li>Image trop petite ‚Üí floue une fois d√©coup√©e.</li>
            {% elseif s == 4 %}
                <li>JSON mal form√© (pense aux virgules et guillemets).</li>
            {% elseif s == 5 %}
                <li>Vid√©o lourde : pense √† compresser (H.264, 720p suffit).</li>
            {% elseif s == 6 %}
                <li>Selector incorrect (ex. <code>#id</code> qui n‚Äôexiste pas).</li>
            {% endif %}
        </ul>
    </div>

    {# Exemples pr√™ts √† copier (pour 4,5,6) #}
    {% if s in [4,5,6] %}
        <div class="step-section">
            <h3>Exemple</h3>
            {% if s == 4 %}
                <pre class="code" data-copy>
Format A (simple) :
[
  {
    "label":"Coche le vrai",
    "options":[{"id":"A","label":"2+2=4"},{"id":"B","label":"2+2=5"}],
    "solution":{"must":["A"],"mustNot":["B"]}
  }
]

Format B (objet) :
{
  "questions": [
    {
      "label":"Coche le vrai",
      "options":[{"id":"A","label":"2+2=4"},{"id":"B","label":"2+2=5"}],
      "solution":{"must":["A"],"mustNot":["B"]}
    }
  ]
}
        </pre>
            {% elseif s == 5 %}
                <pre class="code" data-copy>
[
  {
    "time":12,
    "question":"Mot √† l'√©cran ?",
    "options":[{"id":"A","label":"ALPHA"},{"id":"B","label":"BETA"}],
    "answer":"B",
    "feedbackOk":"Exact !",
    "feedbackKo":"Regarde bien."
  }
]
        </pre>
            {% elseif s == 6 %}
                <pre class="code" data-copy>
[
  {"type":"selectorExists","selector":"h1"},
  {"type":"textIncludes","selector":"h1","text":"SECRET"},
  {"type":"selectorCountAtLeast","selector":"a","count":1}
]
        </pre>
            {% endif %}
            <button type="button" class="btn btn-light btn-copy" data-action="click->copy#run">Copier</button>
        </div>
    {% endif %}
</aside>
