{% extends '../ar/base.html.twig' %}

{% block body %}
    <section class="container mx-auto p-4">
        <h1>Lotus Respire — Version CDN (AR.js)</h1>
        <p>1) Autorise la caméra • 2) Pointe le <a href="https://raw.githubusercontent.com/AR-js-org/AR.js/master/three.js/examples/marker-training/examples/pattern-files/hiro.png" target="_blank" rel="noopener">marqueur hiro</a>.</p>
        {#  <a href="{{ asset('markers/hiro-marker.png') }}" download>Imprimer le marqueur</a> #}
    </section>

    <!-- A-Frame + AR.js (CDN pour l’atelier) -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

    <a-scene
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false;"
        renderer="antialias: true"
        vr-mode-ui="enabled: false"
    >
        <!-- Lumière douce -->
        <a-entity light="type: ambient; intensity: 0.8"></a-entity>
        <a-entity light="type: directional; intensity: 0.6" position="1 1 0"></a-entity>

        <!-- Marqueur hiro -->
        <a-marker preset="hiro" id="marker-lotus">
            <!-- Lotus 3D (place ton .glb en assets/build ou public/models) -->
            <a-entity
                id="lotus"
                gltf-model="url(/models/lotus.glb)"
                position="0 0 0"
                rotation="0 0 0"
                scale="0.5 0.5 0.5"
                animation__breath="property=scale; dir=alternate; dur=4000; easing=easeInOutSine; loop=true; to=0.6 0.6 0.6"
            ></a-entity>

            <!-- si pas de modèle 3d remplace "<a-entity id="lotus" gltf-model="url(/models/lotus.glb)"-->
            {#
            <a-sphere radius="0.25" color="#43b581" animation__breath="property=scale;
             dir=alternate; dur=4000; loop:true; to=1.2 1.2 1.2">
            </a-sphere>
            #}

            <!-- Anneau d’aide visuelle (métronome respiration) -->
            <a-ring color="#ffffff" radius-inner="0.45" radius-outer="0.5"
                    animation__pulse="property=scale; dir=alternate; dur=4000; loop=true; to=1.1 1.1 1.1">
            </a-ring>

            <!-- Son d’ambiance (optionnel) -->
            <a-sound src="url(/audio/forest.mp3)" autoplay="false" loop="true" id="ambience"></a-sound>
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

    <!-- Bouton son via Stimulus (facultatif) -->
 {#    <div data-controller="ar-audio" class="fixed bottom-4 right-4">
        <button data-action="click->ar-audio#toggle" class="px-3 py-2 rounded bg-green-600 text-white">
            Son ON/OFF
        </button>
    </div>
 #}
{% endblock %}
